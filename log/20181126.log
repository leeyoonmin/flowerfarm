#SQL#Ledger_model->getDailyData #ByID # [2018-11-26 09:27:21] 

      SELECT
       AA.TYPE_NM
      , AA.TYPE_CD
      , AA.DATE
      , AA.DATE_STR
      , SUM(AA.AMOUNT) AS AMOUNT
      FROM(
    SELECT
    	  A.USER_ID
      , '지출' AS TYPE_NM
      , '02' AS TYPE_CD
      , SUBSTR(A.ORDER_TIME,1,8) AS DATE
      , CONCAT(SUBSTR(A.ORDER_TIME,1,4),'년 ',SUBSTR(A.ORDER_TIME,5,2),'월') AS DATE_STR
      , SUM(B.ORDER_PRICE*B.ORDER_AMOUNT)
        +(CASE WHEN A.DELIVERY_TYPE = '01'
               THEN (SELECT CODE FROM COMMON_CODE_TB WHERE CODE_DV = '배송비' AND CODE_NM = '직접배송')
               WHEN A.DELIVERY_TYPE = '02'
               THEN (SELECT CODE FROM COMMON_CODE_TB WHERE CODE_DV = '배송비' AND CODE_NM = '퀵서비스')
               WHEN A.DELIVERY_TYPE = '03'
               THEN (SELECT CODE FROM COMMON_CODE_TB WHERE CODE_DV = '배송비' AND CODE_NM = '택배배송')
            ELSE 0 END) AS AMOUNT
      FROM ORDER_TB A
         , ORDER_ITEM_TB B
     WHERE A.ORDER_ID = B.ORDER_ID
       AND A.ORDER_STAT <> 99
     GROUP BY USER_ID, SUBSTR(A.ORDER_TIME,1,8)

     UNION ALL

     SELECT
     	 A.USER_ID
      , (SELECT CODE_NM FROM COMMON_CODE_TB WHERE CODE_DV = '장부입출구분코드' AND CODE = A.TYPE) AS TYPE_NM
      , A.TYPE AS TYPE_CD
      , SUBSTR(A.DATE,1,8) AS DATE
      , CONCAT(SUBSTR(A.DATE,1,4),'년 ',SUBSTR(A.DATE,5,2),'월') AS DATE_STR
      , A.AMOUNT
      FROM LEDGER_TB A
         , LEDGER_CATE_TB B
      WHERE A.USER_ID = B.USER_ID
       AND A.TYPE = B.TYPE
       AND A.CATE = B.CATE_CODE
      ) AA
      WHERE 1=1
      AND AA.USER_ID = ''
      AND SUBSTR(AA.DATE,1,4) = '2018'
      AND SUBSTR(AA.DATE,5,2) = '11'
      GROUP BY AA.DATE , AA.TYPE_CD
      
==========================================================
		Empty Result
==========================================================
#SQL#Ledger_model->getCateByType #ByID # [2018-11-26 09:27:21] 

      SELECT
          CATE_CODE
        , CATE_NAME
        FROM LEDGER_CATE_TB
        WHERE USER_ID = ''
        AND TYPE = '01'
      
==========================================================
		Empty Result
==========================================================
#SQL#Ledger_model->getCateByType #ByID # [2018-11-26 09:27:21] 

      SELECT
          CATE_CODE
        , CATE_NAME
        FROM LEDGER_CATE_TB
        WHERE USER_ID = ''
        AND TYPE = '02'
      
==========================================================
		Empty Result
==========================================================
#SQL#Ledger_model->getDailyData #ByID testfarm# [2018-11-26 09:27:23] 

      SELECT
       AA.TYPE_NM
      , AA.TYPE_CD
      , AA.DATE
      , AA.DATE_STR
      , SUM(AA.AMOUNT) AS AMOUNT
      FROM(
    SELECT
    	  A.USER_ID
      , '지출' AS TYPE_NM
      , '02' AS TYPE_CD
      , SUBSTR(A.ORDER_TIME,1,8) AS DATE
      , CONCAT(SUBSTR(A.ORDER_TIME,1,4),'년 ',SUBSTR(A.ORDER_TIME,5,2),'월') AS DATE_STR
      , SUM(B.ORDER_PRICE*B.ORDER_AMOUNT)
        +(CASE WHEN A.DELIVERY_TYPE = '01'
               THEN (SELECT CODE FROM COMMON_CODE_TB WHERE CODE_DV = '배송비' AND CODE_NM = '직접배송')
               WHEN A.DELIVERY_TYPE = '02'
               THEN (SELECT CODE FROM COMMON_CODE_TB WHERE CODE_DV = '배송비' AND CODE_NM = '퀵서비스')
               WHEN A.DELIVERY_TYPE = '03'
               THEN (SELECT CODE FROM COMMON_CODE_TB WHERE CODE_DV = '배송비' AND CODE_NM = '택배배송')
            ELSE 0 END) AS AMOUNT
      FROM ORDER_TB A
         , ORDER_ITEM_TB B
     WHERE A.ORDER_ID = B.ORDER_ID
       AND A.ORDER_STAT <> 99
     GROUP BY USER_ID, SUBSTR(A.ORDER_TIME,1,8)

     UNION ALL

     SELECT
     	 A.USER_ID
      , (SELECT CODE_NM FROM COMMON_CODE_TB WHERE CODE_DV = '장부입출구분코드' AND CODE = A.TYPE) AS TYPE_NM
      , A.TYPE AS TYPE_CD
      , SUBSTR(A.DATE,1,8) AS DATE
      , CONCAT(SUBSTR(A.DATE,1,4),'년 ',SUBSTR(A.DATE,5,2),'월') AS DATE_STR
      , A.AMOUNT
      FROM LEDGER_TB A
         , LEDGER_CATE_TB B
      WHERE A.USER_ID = B.USER_ID
       AND A.TYPE = B.TYPE
       AND A.CATE = B.CATE_CODE
      ) AA
      WHERE 1=1
      AND AA.USER_ID = 'testfarm'
      AND SUBSTR(AA.DATE,1,4) = '2018'
      AND SUBSTR(AA.DATE,5,2) = '11'
      GROUP BY AA.DATE , AA.TYPE_CD
      
==========================================================
		Empty Result
==========================================================
#SQL#Ledger_model->getCateByType #ByID testfarm# [2018-11-26 09:27:23] 

      SELECT
          CATE_CODE
        , CATE_NAME
        FROM LEDGER_CATE_TB
        WHERE USER_ID = 'testfarm'
        AND TYPE = '01'
      
==========================================================
		Empty Result
==========================================================
#SQL#Ledger_model->getCateByType #ByID testfarm# [2018-11-26 09:27:23] 

      SELECT
          CATE_CODE
        , CATE_NAME
        FROM LEDGER_CATE_TB
        WHERE USER_ID = 'testfarm'
        AND TYPE = '02'
      
==========================================================
		Empty Result
==========================================================
#SQL#Ledger_model->getDailyData #ByID testfarm# [2018-11-26 09:27:25] 

      SELECT
       AA.TYPE_NM
      , AA.TYPE_CD
      , AA.DATE
      , AA.DATE_STR
      , SUM(AA.AMOUNT) AS AMOUNT
      FROM(
    SELECT
    	  A.USER_ID
      , '지출' AS TYPE_NM
      , '02' AS TYPE_CD
      , SUBSTR(A.ORDER_TIME,1,8) AS DATE
      , CONCAT(SUBSTR(A.ORDER_TIME,1,4),'년 ',SUBSTR(A.ORDER_TIME,5,2),'월') AS DATE_STR
      , SUM(B.ORDER_PRICE*B.ORDER_AMOUNT)
        +(CASE WHEN A.DELIVERY_TYPE = '01'
               THEN (SELECT CODE FROM COMMON_CODE_TB WHERE CODE_DV = '배송비' AND CODE_NM = '직접배송')
               WHEN A.DELIVERY_TYPE = '02'
               THEN (SELECT CODE FROM COMMON_CODE_TB WHERE CODE_DV = '배송비' AND CODE_NM = '퀵서비스')
               WHEN A.DELIVERY_TYPE = '03'
               THEN (SELECT CODE FROM COMMON_CODE_TB WHERE CODE_DV = '배송비' AND CODE_NM = '택배배송')
            ELSE 0 END) AS AMOUNT
      FROM ORDER_TB A
         , ORDER_ITEM_TB B
     WHERE A.ORDER_ID = B.ORDER_ID
       AND A.ORDER_STAT <> 99
     GROUP BY USER_ID, SUBSTR(A.ORDER_TIME,1,8)

     UNION ALL

     SELECT
     	 A.USER_ID
      , (SELECT CODE_NM FROM COMMON_CODE_TB WHERE CODE_DV = '장부입출구분코드' AND CODE = A.TYPE) AS TYPE_NM
      , A.TYPE AS TYPE_CD
      , SUBSTR(A.DATE,1,8) AS DATE
      , CONCAT(SUBSTR(A.DATE,1,4),'년 ',SUBSTR(A.DATE,5,2),'월') AS DATE_STR
      , A.AMOUNT
      FROM LEDGER_TB A
         , LEDGER_CATE_TB B
      WHERE A.USER_ID = B.USER_ID
       AND A.TYPE = B.TYPE
       AND A.CATE = B.CATE_CODE
      ) AA
      WHERE 1=1
      AND AA.USER_ID = 'testfarm'
      AND SUBSTR(AA.DATE,1,4) = '2018'
      AND SUBSTR(AA.DATE,5,2) = '11'
      GROUP BY AA.DATE , AA.TYPE_CD
      
==========================================================
		Empty Result
==========================================================
#SQL#Ledger_model->getCateByType #ByID testfarm# [2018-11-26 09:27:25] 

      SELECT
          CATE_CODE
        , CATE_NAME
        FROM LEDGER_CATE_TB
        WHERE USER_ID = 'testfarm'
        AND TYPE = '01'
      
==========================================================
		Empty Result
==========================================================
#SQL#Ledger_model->getCateByType #ByID testfarm# [2018-11-26 09:27:25] 

      SELECT
          CATE_CODE
        , CATE_NAME
        FROM LEDGER_CATE_TB
        WHERE USER_ID = 'testfarm'
        AND TYPE = '02'
      
==========================================================
		Empty Result
==========================================================
#SQL#Ledger_model->getDailyData #ByID testfarm# [2018-11-26 09:37:54] 

      SELECT
       AA.TYPE_NM
      , AA.TYPE_CD
      , AA.DATE
      , AA.DATE_STR
      , SUM(AA.AMOUNT) AS AMOUNT
      FROM(
    SELECT
    	  A.USER_ID
      , '지출' AS TYPE_NM
      , '02' AS TYPE_CD
      , SUBSTR(A.ORDER_TIME,1,8) AS DATE
      , CONCAT(SUBSTR(A.ORDER_TIME,1,4),'년 ',SUBSTR(A.ORDER_TIME,5,2),'월') AS DATE_STR
      , SUM(B.ORDER_PRICE*B.ORDER_AMOUNT)
        +(CASE WHEN A.DELIVERY_TYPE = '01'
               THEN (SELECT CODE FROM COMMON_CODE_TB WHERE CODE_DV = '배송비' AND CODE_NM = '직접배송')
               WHEN A.DELIVERY_TYPE = '02'
               THEN (SELECT CODE FROM COMMON_CODE_TB WHERE CODE_DV = '배송비' AND CODE_NM = '퀵서비스')
               WHEN A.DELIVERY_TYPE = '03'
               THEN (SELECT CODE FROM COMMON_CODE_TB WHERE CODE_DV = '배송비' AND CODE_NM = '택배배송')
            ELSE 0 END) AS AMOUNT
      FROM ORDER_TB A
         , ORDER_ITEM_TB B
     WHERE A.ORDER_ID = B.ORDER_ID
       AND A.ORDER_STAT <> 99
     GROUP BY USER_ID, SUBSTR(A.ORDER_TIME,1,8)

     UNION ALL

     SELECT
     	 A.USER_ID
      , (SELECT CODE_NM FROM COMMON_CODE_TB WHERE CODE_DV = '장부입출구분코드' AND CODE = A.TYPE) AS TYPE_NM
      , A.TYPE AS TYPE_CD
      , SUBSTR(A.DATE,1,8) AS DATE
      , CONCAT(SUBSTR(A.DATE,1,4),'년 ',SUBSTR(A.DATE,5,2),'월') AS DATE_STR
      , A.AMOUNT
      FROM LEDGER_TB A
         , LEDGER_CATE_TB B
      WHERE A.USER_ID = B.USER_ID
       AND A.TYPE = B.TYPE
       AND A.CATE = B.CATE_CODE
      ) AA
      WHERE 1=1
      AND AA.USER_ID = 'testfarm'
      AND SUBSTR(AA.DATE,1,4) = '2018'
      AND SUBSTR(AA.DATE,5,2) = '11'
      GROUP BY AA.DATE , AA.TYPE_CD
      
==========================================================
		Empty Result
==========================================================
#SQL#Ledger_model->getCateByType #ByID testfarm# [2018-11-26 09:37:54] 

      SELECT
          CATE_CODE
        , CATE_NAME
        FROM LEDGER_CATE_TB
        WHERE USER_ID = 'testfarm'
        AND TYPE = '01'
      
==========================================================
		Empty Result
==========================================================
#SQL#Ledger_model->getCateByType #ByID testfarm# [2018-11-26 09:37:54] 

      SELECT
          CATE_CODE
        , CATE_NAME
        FROM LEDGER_CATE_TB
        WHERE USER_ID = 'testfarm'
        AND TYPE = '02'
      
==========================================================
		Empty Result
==========================================================
#SQL#Ledger_model->getDailyData #ByID testfarm# [2018-11-26 09:38:03] 

      SELECT
       AA.TYPE_NM
      , AA.TYPE_CD
      , AA.DATE
      , AA.DATE_STR
      , SUM(AA.AMOUNT) AS AMOUNT
      FROM(
    SELECT
    	  A.USER_ID
      , '지출' AS TYPE_NM
      , '02' AS TYPE_CD
      , SUBSTR(A.ORDER_TIME,1,8) AS DATE
      , CONCAT(SUBSTR(A.ORDER_TIME,1,4),'년 ',SUBSTR(A.ORDER_TIME,5,2),'월') AS DATE_STR
      , SUM(B.ORDER_PRICE*B.ORDER_AMOUNT)
        +(CASE WHEN A.DELIVERY_TYPE = '01'
               THEN (SELECT CODE FROM COMMON_CODE_TB WHERE CODE_DV = '배송비' AND CODE_NM = '직접배송')
               WHEN A.DELIVERY_TYPE = '02'
               THEN (SELECT CODE FROM COMMON_CODE_TB WHERE CODE_DV = '배송비' AND CODE_NM = '퀵서비스')
               WHEN A.DELIVERY_TYPE = '03'
               THEN (SELECT CODE FROM COMMON_CODE_TB WHERE CODE_DV = '배송비' AND CODE_NM = '택배배송')
            ELSE 0 END) AS AMOUNT
      FROM ORDER_TB A
         , ORDER_ITEM_TB B
     WHERE A.ORDER_ID = B.ORDER_ID
       AND A.ORDER_STAT <> 99
     GROUP BY USER_ID, SUBSTR(A.ORDER_TIME,1,8)

     UNION ALL

     SELECT
     	 A.USER_ID
      , (SELECT CODE_NM FROM COMMON_CODE_TB WHERE CODE_DV = '장부입출구분코드' AND CODE = A.TYPE) AS TYPE_NM
      , A.TYPE AS TYPE_CD
      , SUBSTR(A.DATE,1,8) AS DATE
      , CONCAT(SUBSTR(A.DATE,1,4),'년 ',SUBSTR(A.DATE,5,2),'월') AS DATE_STR
      , A.AMOUNT
      FROM LEDGER_TB A
         , LEDGER_CATE_TB B
      WHERE A.USER_ID = B.USER_ID
       AND A.TYPE = B.TYPE
       AND A.CATE = B.CATE_CODE
      ) AA
      WHERE 1=1
      AND AA.USER_ID = 'testfarm'
      AND SUBSTR(AA.DATE,1,4) = '2018'
      AND SUBSTR(AA.DATE,5,2) = '11'
      GROUP BY AA.DATE , AA.TYPE_CD
      
==========================================================
		Empty Result
==========================================================
#SQL#Ledger_model->getCateByType #ByID testfarm# [2018-11-26 09:38:03] 

      SELECT
          CATE_CODE
        , CATE_NAME
        FROM LEDGER_CATE_TB
        WHERE USER_ID = 'testfarm'
        AND TYPE = '01'
      
==========================================================
		Empty Result
==========================================================
#SQL#Ledger_model->getCateByType #ByID testfarm# [2018-11-26 09:38:03] 

      SELECT
          CATE_CODE
        , CATE_NAME
        FROM LEDGER_CATE_TB
        WHERE USER_ID = 'testfarm'
        AND TYPE = '02'
      
==========================================================
		Empty Result
==========================================================
#SQL#Ledger_model->getDailyData #ByID testfarm# [2018-11-26 09:38:15] 

      SELECT
       AA.TYPE_NM
      , AA.TYPE_CD
      , AA.DATE
      , AA.DATE_STR
      , SUM(AA.AMOUNT) AS AMOUNT
      FROM(
    SELECT
    	  A.USER_ID
      , '지출' AS TYPE_NM
      , '02' AS TYPE_CD
      , SUBSTR(A.ORDER_TIME,1,8) AS DATE
      , CONCAT(SUBSTR(A.ORDER_TIME,1,4),'년 ',SUBSTR(A.ORDER_TIME,5,2),'월') AS DATE_STR
      , SUM(B.ORDER_PRICE*B.ORDER_AMOUNT)
        +(CASE WHEN A.DELIVERY_TYPE = '01'
               THEN (SELECT CODE FROM COMMON_CODE_TB WHERE CODE_DV = '배송비' AND CODE_NM = '직접배송')
               WHEN A.DELIVERY_TYPE = '02'
               THEN (SELECT CODE FROM COMMON_CODE_TB WHERE CODE_DV = '배송비' AND CODE_NM = '퀵서비스')
               WHEN A.DELIVERY_TYPE = '03'
               THEN (SELECT CODE FROM COMMON_CODE_TB WHERE CODE_DV = '배송비' AND CODE_NM = '택배배송')
            ELSE 0 END) AS AMOUNT
      FROM ORDER_TB A
         , ORDER_ITEM_TB B
     WHERE A.ORDER_ID = B.ORDER_ID
       AND A.ORDER_STAT <> 99
     GROUP BY USER_ID, SUBSTR(A.ORDER_TIME,1,8)

     UNION ALL

     SELECT
     	 A.USER_ID
      , (SELECT CODE_NM FROM COMMON_CODE_TB WHERE CODE_DV = '장부입출구분코드' AND CODE = A.TYPE) AS TYPE_NM
      , A.TYPE AS TYPE_CD
      , SUBSTR(A.DATE,1,8) AS DATE
      , CONCAT(SUBSTR(A.DATE,1,4),'년 ',SUBSTR(A.DATE,5,2),'월') AS DATE_STR
      , A.AMOUNT
      FROM LEDGER_TB A
         , LEDGER_CATE_TB B
      WHERE A.USER_ID = B.USER_ID
       AND A.TYPE = B.TYPE
       AND A.CATE = B.CATE_CODE
      ) AA
      WHERE 1=1
      AND AA.USER_ID = 'testfarm'
      AND SUBSTR(AA.DATE,1,4) = '2018'
      AND SUBSTR(AA.DATE,5,2) = '11'
      GROUP BY AA.DATE , AA.TYPE_CD
      
==========================================================
		Empty Result
==========================================================
#SQL#Ledger_model->getCateByType #ByID testfarm# [2018-11-26 09:38:15] 

      SELECT
          CATE_CODE
        , CATE_NAME
        FROM LEDGER_CATE_TB
        WHERE USER_ID = 'testfarm'
        AND TYPE = '01'
      
==========================================================
		Empty Result
==========================================================
#SQL#Ledger_model->getCateByType #ByID testfarm# [2018-11-26 09:38:15] 

      SELECT
          CATE_CODE
        , CATE_NAME
        FROM LEDGER_CATE_TB
        WHERE USER_ID = 'testfarm'
        AND TYPE = '02'
      
==========================================================
		Empty Result
==========================================================
#SQL#Ledger_model->getDailyData #ByID testfarm# [2018-11-26 09:38:16] 

      SELECT
       AA.TYPE_NM
      , AA.TYPE_CD
      , AA.DATE
      , AA.DATE_STR
      , SUM(AA.AMOUNT) AS AMOUNT
      FROM(
    SELECT
    	  A.USER_ID
      , '지출' AS TYPE_NM
      , '02' AS TYPE_CD
      , SUBSTR(A.ORDER_TIME,1,8) AS DATE
      , CONCAT(SUBSTR(A.ORDER_TIME,1,4),'년 ',SUBSTR(A.ORDER_TIME,5,2),'월') AS DATE_STR
      , SUM(B.ORDER_PRICE*B.ORDER_AMOUNT)
        +(CASE WHEN A.DELIVERY_TYPE = '01'
               THEN (SELECT CODE FROM COMMON_CODE_TB WHERE CODE_DV = '배송비' AND CODE_NM = '직접배송')
               WHEN A.DELIVERY_TYPE = '02'
               THEN (SELECT CODE FROM COMMON_CODE_TB WHERE CODE_DV = '배송비' AND CODE_NM = '퀵서비스')
               WHEN A.DELIVERY_TYPE = '03'
               THEN (SELECT CODE FROM COMMON_CODE_TB WHERE CODE_DV = '배송비' AND CODE_NM = '택배배송')
            ELSE 0 END) AS AMOUNT
      FROM ORDER_TB A
         , ORDER_ITEM_TB B
     WHERE A.ORDER_ID = B.ORDER_ID
       AND A.ORDER_STAT <> 99
     GROUP BY USER_ID, SUBSTR(A.ORDER_TIME,1,8)

     UNION ALL

     SELECT
     	 A.USER_ID
      , (SELECT CODE_NM FROM COMMON_CODE_TB WHERE CODE_DV = '장부입출구분코드' AND CODE = A.TYPE) AS TYPE_NM
      , A.TYPE AS TYPE_CD
      , SUBSTR(A.DATE,1,8) AS DATE
      , CONCAT(SUBSTR(A.DATE,1,4),'년 ',SUBSTR(A.DATE,5,2),'월') AS DATE_STR
      , A.AMOUNT
      FROM LEDGER_TB A
         , LEDGER_CATE_TB B
      WHERE A.USER_ID = B.USER_ID
       AND A.TYPE = B.TYPE
       AND A.CATE = B.CATE_CODE
      ) AA
      WHERE 1=1
      AND AA.USER_ID = 'testfarm'
      AND SUBSTR(AA.DATE,1,4) = '2018'
      AND SUBSTR(AA.DATE,5,2) = '11'
      GROUP BY AA.DATE , AA.TYPE_CD
      
==========================================================
		Empty Result
==========================================================
#SQL#Ledger_model->getCateByType #ByID testfarm# [2018-11-26 09:38:16] 

      SELECT
          CATE_CODE
        , CATE_NAME
        FROM LEDGER_CATE_TB
        WHERE USER_ID = 'testfarm'
        AND TYPE = '01'
      
==========================================================
		Empty Result
==========================================================
#SQL#Ledger_model->getCateByType #ByID testfarm# [2018-11-26 09:38:16] 

      SELECT
          CATE_CODE
        , CATE_NAME
        FROM LEDGER_CATE_TB
        WHERE USER_ID = 'testfarm'
        AND TYPE = '02'
      
==========================================================
		Empty Result
==========================================================
#SQL#Ledger_model->getDailyData #ByID testfarm# [2018-11-26 09:38:41] 

      SELECT
       AA.TYPE_NM
      , AA.TYPE_CD
      , AA.DATE
      , AA.DATE_STR
      , SUM(AA.AMOUNT) AS AMOUNT
      FROM(
    SELECT
    	  A.USER_ID
      , '지출' AS TYPE_NM
      , '02' AS TYPE_CD
      , SUBSTR(A.ORDER_TIME,1,8) AS DATE
      , CONCAT(SUBSTR(A.ORDER_TIME,1,4),'년 ',SUBSTR(A.ORDER_TIME,5,2),'월') AS DATE_STR
      , SUM(B.ORDER_PRICE*B.ORDER_AMOUNT)
        +(CASE WHEN A.DELIVERY_TYPE = '01'
               THEN (SELECT CODE FROM COMMON_CODE_TB WHERE CODE_DV = '배송비' AND CODE_NM = '직접배송')
               WHEN A.DELIVERY_TYPE = '02'
               THEN (SELECT CODE FROM COMMON_CODE_TB WHERE CODE_DV = '배송비' AND CODE_NM = '퀵서비스')
               WHEN A.DELIVERY_TYPE = '03'
               THEN (SELECT CODE FROM COMMON_CODE_TB WHERE CODE_DV = '배송비' AND CODE_NM = '택배배송')
            ELSE 0 END) AS AMOUNT
      FROM ORDER_TB A
         , ORDER_ITEM_TB B
     WHERE A.ORDER_ID = B.ORDER_ID
       AND A.ORDER_STAT <> 99
     GROUP BY USER_ID, SUBSTR(A.ORDER_TIME,1,8)

     UNION ALL

     SELECT
     	 A.USER_ID
      , (SELECT CODE_NM FROM COMMON_CODE_TB WHERE CODE_DV = '장부입출구분코드' AND CODE = A.TYPE) AS TYPE_NM
      , A.TYPE AS TYPE_CD
      , SUBSTR(A.DATE,1,8) AS DATE
      , CONCAT(SUBSTR(A.DATE,1,4),'년 ',SUBSTR(A.DATE,5,2),'월') AS DATE_STR
      , A.AMOUNT
      FROM LEDGER_TB A
         , LEDGER_CATE_TB B
      WHERE A.USER_ID = B.USER_ID
       AND A.TYPE = B.TYPE
       AND A.CATE = B.CATE_CODE
      ) AA
      WHERE 1=1
      AND AA.USER_ID = 'testfarm'
      AND SUBSTR(AA.DATE,1,4) = '2018'
      AND SUBSTR(AA.DATE,5,2) = '11'
      GROUP BY AA.DATE , AA.TYPE_CD
      
==========================================================
		Empty Result
==========================================================
#SQL#Ledger_model->getCateByType #ByID testfarm# [2018-11-26 09:38:41] 

      SELECT
          CATE_CODE
        , CATE_NAME
        FROM LEDGER_CATE_TB
        WHERE USER_ID = 'testfarm'
        AND TYPE = '01'
      
==========================================================
		Empty Result
==========================================================
#SQL#Ledger_model->getCateByType #ByID testfarm# [2018-11-26 09:38:41] 

      SELECT
          CATE_CODE
        , CATE_NAME
        FROM LEDGER_CATE_TB
        WHERE USER_ID = 'testfarm'
        AND TYPE = '02'
      
==========================================================
		Empty Result
==========================================================
#SQL#Ledger_model->getMonthDataByMonth #ByID testfarm# [2018-11-26 09:38:43] 

      SELECT
        AA.IDXKEY
      , AA.USER_ID
      , AA.TYPE_NM
      , AA.TYPE_CD
      , AA.CATE
      , AA.DATE
      , AA.DATE_STR
      , AA.AMOUNT
      , AA.IS_LEDGER
      , AA.TEXT
      FROM(
    SELECT
        A.ORDER_ID AS IDXKEY
      , A.USER_ID
      , '지출' AS TYPE_NM
      , '02' AS TYPE_CD
      , SUBSTR(A.ORDER_TIME,1,8) AS DATE
      , '꽃팜구매' AS CATE
      , CONCAT(SUBSTR(A.ORDER_TIME,1,4),'-',SUBSTR(A.ORDER_TIME,5,2),'-',SUBSTR(A.ORDER_TIME,7,2)) AS DATE_STR
      , SUM(B.ORDER_PRICE*B.ORDER_AMOUNT)
        +(CASE WHEN A.DELIVERY_TYPE = '01'
               THEN (SELECT CODE FROM COMMON_CODE_TB WHERE CODE_DV = '배송비' AND CODE_NM = '직접배송')
               WHEN A.DELIVERY_TYPE = '02'
               THEN (SELECT CODE FROM COMMON_CODE_TB WHERE CODE_DV = '배송비' AND CODE_NM = '퀵서비스')
               WHEN A.DELIVERY_TYPE = '03'
               THEN (SELECT CODE FROM COMMON_CODE_TB WHERE CODE_DV = '배송비' AND CODE_NM = '택배배송')
            ELSE 0 END) AS AMOUNT
      , 'N' AS IS_LEDGER
      , CONCAT((SELECT PRODUCT_NAME FROM PRODUCT_TB WHERE PRODUCT_ID = B.PRODUCT_ID),'외 ',COUNT(1),'종') AS TEXT
      FROM ORDER_TB A
         , ORDER_ITEM_TB B
     WHERE A.ORDER_ID = B.ORDER_ID
       AND A.ORDER_STAT <> 99
     GROUP BY USER_ID, SUBSTR(A.ORDER_TIME,1,8)
     UNION ALL
     SELECT
        A.IDXKEY AS IDXKEY
      , A.USER_ID
      , (SELECT CODE_NM FROM COMMON_CODE_TB WHERE CODE_DV = '장부입출구분코드' AND CODE = A.TYPE) AS TYPE_NM
      , A.TYPE AS TYPE_CD
      , SUBSTR(A.DATE,1,8) AS DATE
      , B.CATE_NAME AS CATE
      , CONCAT(SUBSTR(A.DATE,1,4),'-',SUBSTR(A.DATE,5,2),'-',SUBSTR(A.DATE,7,2)) AS DATE_STR
      , A.AMOUNT
      , 'Y' AS IS_LEDGER
      , A.TEXT
      FROM LEDGER_TB A
         , LEDGER_CATE_TB B
      WHERE A.USER_ID = B.USER_ID
       AND A.TYPE = B.TYPE
       AND A.CATE = B.CATE_CODE
      ) AA
      WHERE 1=1
      AND AA.USER_ID = 'testfarm'
      AND SUBSTR(AA.DATE,1,4) = '2018'
      AND SUBSTR(AA.DATE,5,2) = '11'
      
          AND SUBSTR(AA.DATE,7,2) = '01'
        
        ORDER BY DATE_STR
      
==========================================================
		Empty Result
==========================================================
#SQL#Ledger_model->getCateByType #ByID testfarm# [2018-11-26 09:38:43] 

      SELECT
          CATE_CODE
        , CATE_NAME
        FROM LEDGER_CATE_TB
        WHERE USER_ID = 'testfarm'
        AND TYPE = '01'
      
==========================================================
		Empty Result
==========================================================
#SQL#Ledger_model->getCateByType #ByID testfarm# [2018-11-26 09:38:43] 

      SELECT
          CATE_CODE
        , CATE_NAME
        FROM LEDGER_CATE_TB
        WHERE USER_ID = 'testfarm'
        AND TYPE = '02'
      
==========================================================
		Empty Result
==========================================================
